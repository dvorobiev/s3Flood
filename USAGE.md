# Руководство по использованию S3 Flood

## Установка

1. Установите зависимости Python:
   ```bash
   pip install -r requirements.txt
   ```

2. Установите s5cmd:
   ```bash
   brew tap peak/tap
   brew install s5cmd
   ```
   
   Или скачайте с https://github.com/peak/s5cmd/releases

## Настройка

1. Отредактируйте файл `config.yaml` для указания параметров подключения к S3:
   ```yaml
   s3_urls:
     - "http://localhost:9000"  # URL вашего S3-совместимого сервера
   access_key: "your-access-key"
   secret_key: "your-secret-key"
   bucket_name: "test-bucket"
   ```

2. Или используйте интерактивный режим настройки:
   ```bash
   python s3_flood.py --config
   ```

## Запуск

Запустите приложение:
```bash
python s3_flood.py
```

## Как это работает

1. Приложение генерирует тестовые файлы трех размеров:
   - Маленькие: до 100 МБ
   - Средние: до 5 ГБ
   - Большие: до 20 ГБ

2. Затем выполняется цикл тестирования:
   - Загрузка файлов в S3
   - Скачивание файлов в /dev/null (имитация чтения без сохранения)
   - Удаление файлов из S3

3. Собирается статистика по всем операциям

## Режимы работы

- **Обычный режим**: Один цикл тестирования
- **Бесконечный режим**: Непрерывное выполнение циклов с задержкой между ними

## Кластерный режим

Для тестирования кластерных S3-совместимых решений укажите несколько URL в конфигурации:
```yaml
s3_urls:
  - "http://s3-node1:9000"
  - "http://s3-node2:9000"
  - "http://s3-node3:9000"
cluster_mode: true
```

## Мониторинг

Приложение отслеживает следующие метрики:
- Количество завершенных циклов
- Количество загруженных/скачанных/удаленных файлов
- Среднее время на операцию
- Общее время выполнения операций