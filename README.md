# S3 Flood - Инструмент нагрузочного тестирования S3

S3 Flood - это кроссплатформенное приложение с терминальным интерфейсом (TUI), предназначенное для стресс-тестирования S3-совместимых хранилищ, таких как MinIO или AWS S3. Оно позволяет оценить производительность, генерируя тестовые файлы и выполняя параллельные операции загрузки, скачивания и удаления.

## Поддерживаемые платформы

- **Linux** (основная платформа)
- **Windows** (поддержка с версии 1.0.0)
- **macOS** (поддержка базовой функциональности)

## Возможности

- **Интерактивный TUI**: Простая настройка и мониторинг в реальном времени
- **Настраиваемая генерация файлов**: Создание тестовых файлов разных размеров (маленькие, средние, большие)
- **Параллельные операции**: Выполнение S3-операций параллельно с использованием s5cmd
- **Отслеживание прогресса по файлам**: Индивидуальные индикаторы прогресса для каждой операции
- **Рандомизированная нагрузка**: Случайные параллельные операции чтения/записи
- **Сбор статистики**: Метрики производительности, включая пропускную способность и время операций
- **Режим бесконечного цикла**: Возможность непрерывного стресс-тестирования

## Требования

- Python 3.7+
- Установленный s5cmd и доступный в PATH

## Установка

### Linux/macOS

1. Клонируйте или скачайте этот репозиторий

2. Запустите скрипт установки:
   ```bash
   ./install.sh
   ```

### Windows

1. **Требования для Windows:**
   - Python 3.7+ (скачать с [python.org](https://www.python.org/downloads/))
   - При установке Python обязательно отметьте "Add Python to PATH"

2. **Автоматическая установка:**
   - Скачайте проект с GitHub
   - Запустите `install.bat` от имени администратора
   - Скрипт автоматически установит все зависимости

3. **Ручная установка для Windows:**
   ```cmd
   # Установка Python зависимостей
   pip install -r requirements.txt
   
   # Скачивание s5cmd для Windows
   mkdir tools
   # Скачайте s5cmd с https://github.com/peak/s5cmd/releases
   # Распакуйте s5cmd.exe в папку tools/
   ```

### Универсальная установка

   Этот скрипт выполнит:
   - Проверку Python 3 и pip3
   - Установку s5cmd
   - Создание виртуального окружения Python
   - Установку зависимостей Python из requirements.txt

3. Альтернативно, вы можете установить зависимости вручную:
   ```bash
   # Установка s5cmd
   wget -O s5cmd.tar.gz https://github.com/peak/s5cmd/releases/latest/download/s5cmd_$(uname -s)_$(uname -m).tar.gz
   tar -xzf s5cmd.tar.gz
   sudo install s5cmd /usr/local/bin/
   rm s5cmd.tar.gz

   # Создание виртуального окружения
   python3 -m venv venv
   source venv/bin/activate

   # Установка зависимостей Python
   pip install -r requirements.txt
   ```

## Настройка

Перед запуском приложения настройте его с вашими параметрами S3:

```bash
source venv/bin/activate
python s3_flood.py --config
```

Это запустит интерактивный мастер настройки, где вы сможете задать:
- URL endpoint'ов S3
- Ключ доступа и секретный ключ
- Имя бакета
- Количество параллельных потоков
- Размеры и количество файлов в группах
- Настройки бесконечного цикла

## Использование

### Запуск приложения

### Запуск приложения

**Linux/macOS:**
```bash
./run.sh
```

Или напрямую:
```bash
source venv/bin/activate
python s3_flood.py
```

**Windows:**
```cmd
run.bat
```

Или напрямую:
```cmd
python s3_flood.py
```

### Параметры командной строки

- `python s3_flood.py` - Запуск TUI-приложения
- `python s3_flood.py --config` - Запуск интерактивного мастера настройки

## Структура проекта

```
s3Flood/
├── s3_flood.py              # Основное приложение
├── config.yaml              # Файл конфигурации
├── requirements.txt         # Зависимости Python
├── install.sh               # Скрипт установки
├── run.sh                   # Скрипт запуска
├── README.md                # Этот файл
├── start_minio.sh           # Скрипт запуска MinIO (для тестирования)
├── test_s3_connection.py    # Тест подключения к S3
└── demo/                    # Демо-скрипты
    ├── final_demo.py        # Финальный демо-скрипт
    ├── test_progress.py     # Тест отслеживания прогресса
    └── demo_progress.py     # Демонстрация прогресса
```

## Файл конфигурации

Приложение использует YAML-файл конфигурации ([config.yaml](file:///Users/dvorobiev/s3Flood/config.yaml)) со следующими параметрами:

```yaml
s3_urls:
  - http://localhost:9000        # URL endpoint'ов S3
access_key: minioadmin          # Ключ доступа
secret_key: minioadmin          # Секретный ключ
bucket_name: test-bucket        # Имя бакета
cluster_mode: false             # Режим кластера (несколько endpoint'ов)
parallel_threads: 5             # Количество параллельных потоков
file_groups:
  small:
    max_size_mb: 100            # Макс. размер маленьких файлов (МБ)
    count: 100                  # Количество маленьких файлов
  medium:
    max_size_mb: 5120           # Макс. размер средних файлов (МБ)
    count: 50                   # Количество средних файлов
  large:
    max_size_mb: 20480          # Макс. размер больших файлов (МБ)
    count: 10                   # Количество больших файлов
infinite_loop: true             # Запуск в бесконечном цикле
cycle_delay_seconds: 15         # Задержка между циклами (в секундах)
```

## Зависимости

- Python 3.7+
- questionary==2.0.1
- rich==13.7.1
- PyYAML==6.0.1
- s5cmd (https://github.com/peak/s5cmd)

## Разработка

### Запуск тестов

```bash
source venv/bin/activate
python test_s3_connection.py    # Тест подключения к S3
python demo/final_demo.py       # Запуск демо
```

## Участие в разработке

1. Сделайте форк репозитория
2. Создайте ветку с новой функцией
3. Зафиксируйте изменения
4. Отправьте ветку
5. Создайте Pull Request

## Лицензия

Этот проект лицензирован по лицензии MIT.

## Поддержка

По вопросам и предложениям по функциональности, пожалуйста, откройте issue на GitHub.