## Changelog
### 0.9.8-beta — Завершение интерактивного меню и просмотр метрик
- **Интерактивный запуск тестов**: из меню можно выбрать конфиг, профиль нагрузки (`write/read/mixed`) и при необходимости переопределить ключевые параметры перед стартом (каталог датасета `data_dir`, число потоков `threads`, флаги `infinite` и `unique_remote_names`, а также `mixed_read_ratio` для `mixed` профиля).
- **Проверка конфигов**: расширенное меню «Конфиги и проверка» с мастером создания нового конфига, выбором и проверкой существующего, быстрым тестом доступа к бакету через `head-bucket` и безопасным удалением всех объектов только при явном подтверждении.
- **Просмотр метрик**: добавлен пункт «Просмотр метрик», который парсит `metrics.csv`, показывает сводную статистику (успешные/ошибочные операции, суммарный объём, среднюю/медианную/P90 скорость) и топ‑10 самых быстрых операций в виде таблиц `rich`.

### 0.9.7-beta — Конфиги и интерактивные операции
- **Меню конфигов**: пункты управления и проверки конфигов объединены в единое меню «Конфиги и проверка» с возможностью создать новый конфиг, выбрать существующий и запустить его проверку.
- **Индикация долгих операций**: добавлен точечный спиннер для запуска профиля, создания датасета и полного удаления объектов из бакета (через `aws s3 rm --recursive`).
- **Безопасное удаление**: удаление всех объектов из бакета доступно только при успешном получении списка объектов и сопровождается двойным подтверждением и визуальным индикатором выполнения.

### 0.9.6-beta — Интерактивное меню (WIP)
- **Interactive menu**: добавлено интерактивное TUI-меню на базе `textual`. Запускается через `s3flood` без аргументов или `s3flood --interactive`. Пока реализована базовая структура с главным меню и заглушками для всех функций.
- **Backward compatibility**: все существующие CLI-команды продолжают работать как раньше.

### 0.9.7-beta — Конфиги и интерактивные операции
- **Меню конфигов**: пункты управления и проверки конфигов объединены в единое меню «Конфиги и проверка» с возможностью создать новый конфиг, выбрать существующий и запустить его проверку.
- **Индикация долгих операций**: добавлен точечный спиннер для запуска профиля, создания датасета и полного удаления объектов из бакета (через `aws s3 rm --recursive`).
- **Безопасное удаление**: удаление всех объектов из бакета доступно только при успешном получении списка объектов и сопровождается двойным подтверждением и визуальным индикатором выполнения.

### 0.9.5-beta — Исправление read-профиля
- **S3 read jobs**: профиль `read` больше не сканирует локальный датасет. Теперь задачи формируются только из списка объектов, полученного из бакета, поэтому запрашиваются правильные ключи и уходят ошибки `NoSuchKey`.

### 0.9.4-beta — Уникальные имена объектов и чистый sample-config
- **Unique remote names**: добавлена опция `unique_remote_names` (и флаг CLI `--unique-remote-names`), автоматически добавляющая уникальный постфикс к каждому upload'у. Полезно для бесконечных прогонов и повторных запусков, чтобы не перезаписывать старые объекты.
- **Safe sample config**: `config.sample.yaml` снова содержит только плейсхолдеры и пример `aws_profile`, так что его можно смело коммитить/копировать.

### 0.9.3-beta — Баланс активных и завершённых операций
- **Split recent ops**: дашборд теперь показывает до `threads` завершённых файлов и столько же активных — значения не исчезают сразу, а новые операции вытесняют старые снизу вверх.
- **Глубокий буфер**: увеличена глубина хранения истории Recent ops, чтобы завершённые операции не терялись при большом числе потоков.

### 0.9.2-beta — Живой список Recent ops
- **Instant Recent ops**: каждая операция появляется в списке сразу после старта (показываем имя и размер), скорость и время автоматически обновляются по завершении.
- **Limited rows**: количество отображаемых строк ограничено `min(threads, 15)` — интерфейс остаётся компактным даже при большом числе потоков.
- **Более информативные записи**: для незавершённых операций выводим текущее время выполнения, для завершённых — фактическую длительность и скорость.

### 0.9.1-beta — Улучшения дашборда
- **Перерисовка TUI**: таблица стала одноколоночной без дублирующего блока Recent files.
- **Блок Rates**: убран параметр `last`, оставлены только актуальные скорости.
- **Recent ops**: теперь выводит размер файла в гигабайтах, длительность операции в секундах и скорость; данные берутся из расширенной метрики.

### 0.9.0-beta — Переработанные профили нагрузки и порядок обработки файлов
- **Переработанные профили**: `write-heavy` → `write` (только запись), `read-heavy` → `read` (только чтение из бакета)
- **Профиль `write`**: только запись файлов из датасета в бакет, без фазы чтения
- **Профиль `read`**: только чтение объектов из бакета (в `/dev/null`), получает список объектов через `s3api list-objects-v2`
- **Порядок обработки**: добавлена опция `--order` (sequential/random) для выбора порядка обработки файлов
  - `sequential`: сначала маленькие файлы, потом средние, потом большие (по умолчанию)
  - `random`: случайный порядок обработки файлов
- **Улучшения**: обновлена логика отображения дашборда для новых профилей, улучшена обработка ошибок

### 0.9.0-alpha — Portable дистрибутив для Windows и упрощение документации
- **Portable дистрибутив для Windows**: добавлен автоматический workflow `windows-portable` для сборки portable дистрибутива с Python embedded и всеми зависимостями. Не требует установки Python на целевой машине.
- **Скрипт сборки**: добавлен `build-windows-portable.sh` для локальной сборки portable дистрибутива.
- **Исправления portable дистрибутива**: автоматическое раскомментирование `import site` в `python311._pth`, правильная установка зависимостей в `Lib/site-packages`.
- **Улучшения Windows exe**: исправлена сборка через PyInstaller, добавлена проверка работоспособности после сборки, автоматическое прикрепление к релизам.
- **Упрощение документации**: полностью переписан README — убраны избыточные детали, оставлены только простые и понятные инструкции.
- **Улучшения CLI**: добавлены подробные описания для всех аргументов в `--help`.
- **Исправления**: отключение ANSI escape-кодов на Windows для корректного отображения дашборда, исправления в workflow для корректной работы на Windows runner.

### 0.3.2 — Fix BadDigest on Windows uploads
- Uploads `<5 ГБ` теперь выполняются одиночным `put-object` (мы поднимаем `multipart_threshold` через `AWS_CLI_FILE_TRANSFER_CONFIG`). Это устраняет `BadDigest` на S3-совместимых хранилищах без поддержки CRC32.
- README дополнен примерами компактного датасета и советами по размерам файлов.

### 0.3.1 — Windows bundle и офлайн-инструкции
- Добавлен workflow `windows-bundle`, автоматически собирающий `s3flood.exe` через PyInstaller и прикрепляющий `s3flood-windows.zip` к релизам/артефактам.
- README пополнился подробной инструкцией по офлайн-развёртыванию на Windows и ссылкой на готовый ZIP.
- Удалены локальные артефакты (`build/`, `loadset/`, `wheels/`, `.DS_Store`), актуализирован `.gitignore`.
- Версия пакета обновлена до 0.3.1.
### 0.3.0 — расширенные профили нагрузки и улучшения кластерного режима
- Реализованы профили `read-heavy` и `mixed` (ранее `mixed-70-30`): сначала запись данных, затем чтение или смешанные операции.
- Добавлена поддержка паттернов нагрузки `sustained` (ровная) и `bursty` (всплески) с настраиваемыми параметрами.
- Улучшен кластерный режим: объекты читаются через тот же endpoint, через который были записаны.
- Добавлено управление очередью: лимиты размера очереди, retry с экспоненциальным backoff.
- Расширена конфигурация: параметры `mixed_read_ratio`, `pattern`, `burst_duration_sec`, `burst_intensity_multiplier`, `queue_limit`, `max_retries`, `retry_backoff_base`.
- Улучшен дашборд: отображение текущего профиля, фазы (WRITE/READ/MIXED), статуса паттерна bursty.
- Обновлена документация: описание новых профилей и параметров конфигурации.

### 0.2.3 — скрипт установки и улучшения развёртывания
- Добавлен скрипт установки `install.sh` для Mac и Linux: автоматическая проверка зависимостей, создание venv, установка пакетов.
- Создан wrapper скрипт `./s3flood` для удобного запуска без ручной активации venv.
- Добавлен скрипт синхронизации `sync-to-corporate.sh` для работы с корпоративным Gitea (автоматически исключает CI/CD файлы).
- Улучшена документация по установке и использованию в README.

### 0.2.2 — улучшения UI и исправления
- Исправлена загрузка файлов в `/dev/null`: используется `s3api get-object` вместо `s3 cp` для избежания ошибок обновления времени модификации специального файла.
- Улучшена цветовая схема дашборда: зелёная подсветка для активной фазы (запись/чтение), нейтральный цвет для неактивной.
- Улучшен отображение прогресса фазы чтения: корректный подсчёт активных загрузок, правильный расчёт ETA на основе скорости чтения.
- Убрано сообщение о переходе между фазами для предотвращения смещения дашборда.

### 0.2.1 — фаза чтения в write-heavy профиле
- Профиль `write-heavy` теперь автоматически запускает фазу чтения после завершения всех upload-операций.
- Чтение выполняется в `/dev/null` (или `NUL` на Windows), чтобы не нагружать диск.
- Используется то же количество потоков, что и для записи.
- Прогресс-бар показывает метрики обеих фаз: запись (W) и чтение (R).
- Отдельные процентили latency для upload и download операций.

### 0.2.0 — конфиги и кластерные endpoint'ы
- Поддержка `config.py`: запуск через YAML, AWS CLI профиль, объединение с CLI-флагами.
- Пример конфига `config.sample.yaml`, описание в README.
- `run` принимает `--config`, `--endpoints`, `--endpoint-mode`, `--aws-profile`.
- Кластерный режим: выбор endpoint'а по round-robin или random.
- В итоговом отчёте `SUMMARY` появились поля `write_bytes` и `read_bytes`.

### 0.1.0 — initial cleaned CLI prototype
- Новая минимальная структура `src/s3flood/` (CLI, dataset, executor).
- Генерация датасета с симлинками и сид-файлами.
- Профиль записи с AWS CLI (многопоточность).
- Метрики CSV и итоговый отчёт JSON.
- Очистка репозитория от устаревших скриптов и артефактов.


